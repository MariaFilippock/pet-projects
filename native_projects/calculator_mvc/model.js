import{LOCAL_STORAGE_APP_STATE_KEY}from"./const.js";export class Model{constructor(){this.state=JSON.parse(localStorage.getItem(LOCAL_STORAGE_APP_STATE_KEY))||{result:"",firstArg:"",operator:"",secondArg:""},this.operations=["-","+","/","*","%"]}setState(t){this.state=t,this.saveToLocalStorage()}setResultAndFirstArg(t){this.setState({...this.state,result:t,firstArg:t.toString(),operator:"",secondArg:""})}addComma(t){const s=this.state.operator?"secondArg":"firstArg",e=this.state[s]||"0";e.includes(t)||(this.state[s]=e+t,this.concatResult(),this.saveToLocalStorage(),this.onChange(this.state))}resetOperation(){this.setState({result:"",firstArg:"",operator:"",secondArg:""})}concatResult(){this.state.result=`${this.state.firstArg}${this.state.operator}${this.state.secondArg}`}calculateResult(){const t=t=>Number.isInteger(t)?t:t.toFixed(4);let s=Number(this.state.firstArg),e=Number(this.state.secondArg);"+"===this.state.operator?this.setResultAndFirstArg(t(s+e)):"-"===this.state.operator?this.setResultAndFirstArg(t(s-e)):"/"===this.state.operator&&0===e?this.setResultAndFirstArg("\u041e\u0448\u0438\u0431\u043a\u0430!"):"/"===this.state.operator?this.setResultAndFirstArg(t(s/e)):"*"===this.state.operator?this.setResultAndFirstArg(t(s*e)):"%"===this.state.operator?this.setResultAndFirstArg(s/100):this.setResultAndFirstArg(s),this.concatResult(),this.saveToLocalStorage(),this.onChange(this.state)}addDigitOrOperator(t){this.operations.includes(t)?this.state.operator=t:this.state.operator&&!isNaN(t)?this.state.secondArg+=t:isNaN(t)||(this.state.firstArg+=t),this.concatResult(),this.saveToLocalStorage(),this.onChange(this.state)}onChange(){}initOnChange(t){this.onChange=t}saveToLocalStorage(){localStorage.setItem(LOCAL_STORAGE_APP_STATE_KEY,JSON.stringify(this.state))}}